---
title: "Anchoring Bias in the Stock Market"
author: "Wesley Stone and Alan Schulz Diaz"
date: "12-17-2024"
format: html
editor: visual
categories: Economics
theme: cosmo
---

```{r setup, message=FALSE, warning=FALSE, echo=FALSE}
library(tidyverse)
library(ggplot2)
library(shiny)
library(plotly)
library(tidyquant)
```

```{r data, message=FALSE, echo=FALSE}
finished_data <- read_rds("short_stocks.rds")
```

## Driving Question

We came to this project with a simple question: are there cognitive biases that impact the daily highs and lows in which stocks are traded? In theory, stock prices should be random, as traders' valuations depend on a multitude of factors that are impossible to predict.

However, humans execute transactions and we wondered if there is a tendency for daily high and low prices to cluster around rounded numbers. At first, we thought the best approach would be to investigate the nominal value of a stock. But quickly, we realized stocks' tendency to trade in values less than \$5 was simply because there are more small companies listed in the stock market than larger ones. Then, we came up with the idea of investigating if the last two decimal places of a stock, essentially, its ending cent value, clustered around rounded numbers.

We extracted data from yahoo finance from 2019 to 2024 and plotted graphs to depict what were the most common ending cent values in which daily highs (Figure 1) and daily lows (Figure 2) encountered.

```{r, echo=FALSE}
# Define the metric you want to visualize
chosen_metric <- "High"  # Replace with the metric of your choice

# Create the label dynamically based on the metric
label <- str_c(chosen_metric, "_cat")

# Generate the bar plot
high <- finished_data %>%
  group_by(!!sym(label)) %>%
  count() %>%
  mutate(cent_price = as.numeric(as.character(!!sym(label))) / 100) %>%  # Convert to cent price
  ggplot() +
  geom_bar(aes(x = cent_price, y = n), stat = "identity", fill="darkgreen") +
  labs(
    title = paste("Daily highs, last two digits (cent price): 2019-2024"),
    x = "Cent price",
    y = "Number of Highs"
  ) +
  theme_minimal() +
  scale_y_continuous(labels = scales::comma) +  # Ensure y-axis values are regular counts
  theme_minimal()


# Display the plot
print(high)
```

```{r, echo=FALSE}
# Define the metric you want to visualize
chosen_metric <- "Low"  # Replace with the metric of your choice

# Create the label dynamically based on the metric
label <- str_c(chosen_metric, "_cat")

# Generate the bar plot
low <- finished_data %>%
  group_by(!!sym(label)) %>%
  count() %>%
  mutate(cent_price = as.numeric(as.character(!!sym(label))) / 100) %>%  # Convert to cent price
  ggplot() +
  geom_bar(aes(x = cent_price, y = n), stat = "identity", fill="darkred") +
  labs(
    title = paste("Daily Lows, last two digits (cent price): 2019-2024"),
    x = "Cent price",
    y = "Number of Lows"
  ) +
  theme_minimal() +
  scale_y_continuous(labels = scales::comma) +  # Ensure y-axis values are regular counts
  theme_minimal()


# Display the plot
print(low)
```

## Analysis

These graphs present compelling evidence of anchoring bias. There are high peaks at 0 and 50 cents, as well as other round numbers such as multiples of 10 and 25.

If we look closer, another insight we get from these graphs is highs and lows both peak at rounded cent values, but they behave slightly different on how they approach to that peak. When approaching a daily high, traders keep buying until it reaches the 0 value, with lots of trades ending at 99 cents. Instead, when approaching a daily low, traders will buy at .01 and stop buying at .99. This behavior further reinforces the trend, as these barriers act as as support and tension price points.

However, one of the concerns we had was that low volume stocks were driving this behavior. For example, some stocks can be as pricey as \$200,000, and those stocks are usually traded at rounded numbers and by very few individuals. So we created two interactive shiny apps to allow users to view the trends of their choice. Unfortunately, Github will not host shinys, but we were able to host them remotely using shinyapps.io, and they can be accessed with the links below.

First, we divided all stocks into five categories according to their median volume of daily trades. The user can explore the company size, metric and date of their choice.

[aggregate shiny](https://wesleystone.shinyapps.io/aggregate_shiny/)

Whatever volume you look at, the trend generally maintains. People like rounded numbers and particularly .00 and .50.

The second shiny is for individual stocks. To keep the dropdown manageable, we limited the options to stocks from the S&P 500, minus the nine companies that did not appear in our dataset.

[s&p 500 shiny](https://wesleystone.shinyapps.io/individual_shiny/)

Thanks for checking out our project! We hope you found it as interesting as we did.
